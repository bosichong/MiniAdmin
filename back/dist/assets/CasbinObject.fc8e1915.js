import{a as h,r as f,k as w,b as s,o as P,d as U,c as t,w as o,F as G,g as _,e as v,f as k,j as H,M as c,E as J}from"./index.a51140a0.js";import{E as K,D as L}from"./EditFilled.252faa9b.js";const Q={key:0},Z={__name:"CasbinObject",setup(W){const a=h({co_id:0,name:"",object_key:"",description:""}),p=f(!1),I=w(()=>!(a.name&&a.object_key&&a.description)),O=n=>{_.get("/v1/co/get_co",{params:{co_id:n}}).then(function(e){a.name=e.data.name,a.object_key=e.data.object_key,a.description=e.data.description,a.co_id=n,p.value=!0})},E=()=>{p.value=!1},D=()=>{_.post("/v1/co/update_co",{old_co_id:a.co_id,name:a.name,object_key:a.object_key,description:a.description}).then(function(n){n.data?c.info().update({title:"\u63D0\u793A!",content:"\u4FEE\u6539\u6210\u529F!",onOk:()=>{p.value=!1,b()}}):c.error().update({title:"\u9519\u8BEF!",content:"\u4FEE\u6539\u5931\u8D25!"})}).catch(function(n){c.error().update({title:"\u9519\u8BEF!",content:"\u4FEE\u6539\u5931\u8D25!"+n.response.data.detail})})},T=n=>{c.confirm({title:"\u786E\u5B9A\u8981\u5220\u9664\u5417?",icon:t(J),content:"\u786E\u5B9A\u540E\u4F1A\u5220\u9664\u6B64\u8D44\u6E90\u53CA\u5176\u76F8\u5173\u7684\u6743\u9650!",okText:"\u786E\u5B9A",okType:"danger",cancelText:"\u53D6\u6D88",onOk(){_.get("v1/co/delete_co",{params:{co_id:n}}).then(function(e){e.data&&(b(),c.info().update({title:"\u63D0\u793A!",content:"\u5220\u9664\u6210\u529F!"}))}).catch(function(e){c.error().update({title:"\u63D0\u793A!",content:"\u4FEE\u6539\u5931\u8D25!"+e.response.data.detail})})},onCancel(){console.log("Cancel")}})},i=h({name:"",object_key:"",description:""}),j={name:[{required:!0,message:"Please enter name"}],object_key:[{required:!0,message:"Please enter object_key"}],description:[{required:!0,message:"Please enter  description"}]},u=f(!1),q=()=>{u.value=!0},N=()=>{u.value=!1},y=()=>{_.post("/v1/co/create_co",{name:i.name,object_key:i.object_key,description:i.description,user_id:sessionStorage.getItem("user_id")}).then(function(n){n.data?c.info().update({title:"\u63D0\u793A!",content:"\u521B\u5EFA\u6210\u529F!",onOk:()=>{u.value=!1,b()}}):c.error().update({title:"\u9519\u8BEF!",content:"\u521B\u5EFA\u5931\u8D25!"}),i.name="",i.object_key="",i.description=""}).catch(function(n){n&&c.error().update({title:"\u9519\u8BEF!",content:n.response.data.detail,onOk:()=>{u.value=!1,i.name="",i.object_key="",i.description=""}})})},V=n=>{console.log("Failed:",n)},z=w(()=>!(i.name&&i.object_key&&i.description)),B=f([{title:"Id",dataIndex:"id",key:"id"},{title:"\u540D\u79F0",dataIndex:"name",key:"name"},{title:"\u8D44\u6E90key",dataIndex:"object_key",key:"object_key"},{title:"\u7B80\u4ECB",key:"description",dataIndex:"description"},{title:"\u7BA1\u7406",key:"action"}]),C=f([]),b=()=>{_.get("v1/co/get_cos").then(function(n){C.value=n.data}).catch(function(n){console.log(n)})};return b(),(n,e)=>{const d=s("a-button"),M=s("a-space"),R=s("a-card"),$=s("a-divider"),S=s("a-table"),r=s("a-input"),m=s("a-form-item"),g=s("a-form"),x=s("a-drawer");return P(),U(G,null,[t(R,{style:{"margin-bottom":"10px"}},{default:o(()=>[t(M,null,{default:o(()=>[t(d,{type:"primary",onClick:q},{default:o(()=>[v("\u521B\u5EFA\u8D44\u6E90")]),_:1})]),_:1})]),_:1}),t(S,{columns:B.value,"data-source":C.value},{headerCell:o(({columns:l})=>[]),bodyCell:o(({column:l,record:F})=>[l.key==="action"?(P(),U("span",Q,[t(d,{type:"primary",size:"small",onClick:A=>O(F.id)},{icon:o(()=>[t(k(K))]),_:2},1032,["onClick"]),t($,{type:"vertical"}),t(d,{type:"primary",size:"small",onClick:A=>T(F.id)},{icon:o(()=>[t(k(L))]),_:2},1032,["onClick"])])):H("",!0)]),_:1},8,["columns","data-source"]),t(x,{title:"\u521B\u5EFA\u8D44\u6E90",width:"550",visible:u.value,"onUpdate:visible":e[3]||(e[3]=l=>u.value=l)},{extra:o(()=>[t(d,{onClick:N},{default:o(()=>[v("\u53D6\u6D88")]),_:1}),t(d,{disabled:k(z),type:"primary",onClick:y},{default:o(()=>[v("\u63D0\u4EA4")]),_:1},8,["disabled"])]),default:o(()=>[t(g,{model:i,rules:j,layout:"vertical",onFinish:y,onFinishFailed:V},{default:o(()=>[t(m,{label:"\u8D44\u6E90\u540D\u79F0",name:"name"},{default:o(()=>[t(r,{value:i.name,"onUpdate:value":e[0]||(e[0]=l=>i.name=l),placeholder:"Please enter name"},null,8,["value"])]),_:1}),t(m,{label:"object_key",name:"object_key"},{default:o(()=>[t(r,{value:i.object_key,"onUpdate:value":e[1]||(e[1]=l=>i.object_key=l),placeholder:"Please enter object_key"},null,8,["value"])]),_:1}),t(m,{label:"\u7B80\u4ECB",name:"description"},{default:o(()=>[t(r,{value:i.description,"onUpdate:value":e[2]||(e[2]=l=>i.description=l),placeholder:"Please enter description"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),t(x,{title:"\u7F16\u8F91\u8D44\u6E90",width:"550",visible:p.value,"onUpdate:visible":e[8]||(e[8]=l=>p.value=l)},{extra:o(()=>[t(d,{onClick:E},{default:o(()=>[v("\u53D6\u6D88")]),_:1}),t(d,{disabled:k(I),type:"primary",onClick:D},{default:o(()=>[v("\u63D0\u4EA4")]),_:1},8,["disabled"])]),default:o(()=>[t(g,{model:a,rules:j,layout:"vertical",onFinish:y},{default:o(()=>[t(r,{value:a.co_id,"onUpdate:value":e[4]||(e[4]=l=>a.co_id=l),type:"hidden"},null,8,["value"]),t(m,{label:"\u8D44\u6E90\u540D\u79F0",name:"name"},{default:o(()=>[t(r,{value:a.name,"onUpdate:value":e[5]||(e[5]=l=>a.name=l),placeholder:"Please enter name"},null,8,["value"])]),_:1}),t(m,{label:"object_key",name:"object_key"},{default:o(()=>[t(r,{value:a.object_key,"onUpdate:value":e[6]||(e[6]=l=>a.object_key=l),placeholder:"Please enter object_key"},null,8,["value"])]),_:1}),t(m,{label:"\u7B80\u4ECB",name:"description"},{default:o(()=>[t(r,{value:a.description,"onUpdate:value":e[7]||(e[7]=l=>a.description=l),placeholder:"Please enter description"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}};export{Z as default};
